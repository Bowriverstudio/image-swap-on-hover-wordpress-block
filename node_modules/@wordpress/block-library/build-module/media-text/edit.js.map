{"version":3,"sources":["@wordpress/block-library/src/media-text/edit.js"],"names":["classnames","get","__","_x","compose","withSelect","BlockControls","BlockVerticalAlignmentToolbar","InnerBlocks","InspectorControls","PanelColorSettings","withColors","__experimentalImageURLInputUI","ImageURLInputUI","Component","PanelBody","TextareaControl","ToggleControl","ToolbarGroup","ExternalLink","FocalPointPicker","MediaContainer","TEMPLATE","fontSize","placeholder","WIDTH_CONSTRAINT_PERCENTAGE","applyWidthConstraints","width","Math","max","min","LINK_DESTINATION_MEDIA","LINK_DESTINATION_ATTACHMENT","MediaTextEdit","arguments","onSelectMedia","bind","onWidthChange","commitWidthChange","state","mediaWidth","onSetHref","media","setAttributes","props","attributes","linkDestination","href","mediaType","src","media_type","type","newHref","url","link","mediaAlt","alt","mediaId","id","mediaUrl","mediaLink","undefined","focalPoint","setState","mediaPosition","imageFill","className","backgroundColor","isSelected","setBackgroundColor","image","isStackedOnMobile","verticalAlignment","rel","linkTarget","linkClass","temporaryMediaWidth","classNames","class","color","widthString","gridTemplateColumns","style","msGridColumns","colorSettings","value","onChange","label","toolbarControls","icon","title","isActive","onClick","onMediaAltChange","newMediaAlt","onVerticalAlignmentChange","alignment","mediaTextGeneralSettings","source_url","renderMediaArea","select","getMedia"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { get } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __, _x } from '@wordpress/i18n';\nimport { compose } from '@wordpress/compose';\nimport { withSelect } from '@wordpress/data';\nimport {\n\tBlockControls,\n\tBlockVerticalAlignmentToolbar,\n\tInnerBlocks,\n\tInspectorControls,\n\tPanelColorSettings,\n\twithColors,\n\t__experimentalImageURLInputUI as ImageURLInputUI,\n} from '@wordpress/block-editor';\nimport { Component } from '@wordpress/element';\nimport {\n\tPanelBody,\n\tTextareaControl,\n\tToggleControl,\n\tToolbarGroup,\n\tExternalLink,\n\tFocalPointPicker,\n} from '@wordpress/components';\n/**\n * Internal dependencies\n */\nimport MediaContainer from './media-container';\n\n/**\n * Constants\n */\nconst TEMPLATE = [\n\t[\n\t\t'core/paragraph',\n\t\t{\n\t\t\tfontSize: 'large',\n\t\t\tplaceholder: _x( 'Contentâ€¦', 'content placeholder' ),\n\t\t},\n\t],\n];\n// this limits the resize to a safe zone to avoid making broken layouts\nconst WIDTH_CONSTRAINT_PERCENTAGE = 15;\nconst applyWidthConstraints = ( width ) =>\n\tMath.max(\n\t\tWIDTH_CONSTRAINT_PERCENTAGE,\n\t\tMath.min( width, 100 - WIDTH_CONSTRAINT_PERCENTAGE )\n\t);\n\nconst LINK_DESTINATION_MEDIA = 'media';\nconst LINK_DESTINATION_ATTACHMENT = 'attachment';\n\nclass MediaTextEdit extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.onSelectMedia = this.onSelectMedia.bind( this );\n\t\tthis.onWidthChange = this.onWidthChange.bind( this );\n\t\tthis.commitWidthChange = this.commitWidthChange.bind( this );\n\t\tthis.state = {\n\t\t\tmediaWidth: null,\n\t\t};\n\t\tthis.onSetHref = this.onSetHref.bind( this );\n\t}\n\n\tonSelectMedia( media ) {\n\t\tconst { setAttributes } = this.props;\n\t\tconst { linkDestination, href } = this.props.attributes;\n\n\t\tlet mediaType;\n\t\tlet src;\n\t\t// for media selections originated from a file upload.\n\t\tif ( media.media_type ) {\n\t\t\tif ( media.media_type === 'image' ) {\n\t\t\t\tmediaType = 'image';\n\t\t\t} else {\n\t\t\t\t// only images and videos are accepted so if the media_type is not an image we can assume it is a video.\n\t\t\t\t// video contain the media type of 'file' in the object returned from the rest api.\n\t\t\t\tmediaType = 'video';\n\t\t\t}\n\t\t} else {\n\t\t\t// for media selections originated from existing files in the media library.\n\t\t\tmediaType = media.type;\n\t\t}\n\n\t\tif ( mediaType === 'image' ) {\n\t\t\t// Try the \"large\" size URL, falling back to the \"full\" size URL below.\n\t\t\tsrc =\n\t\t\t\tget( media, [ 'sizes', 'large', 'url' ] ) ||\n\t\t\t\tget( media, [\n\t\t\t\t\t'media_details',\n\t\t\t\t\t'sizes',\n\t\t\t\t\t'large',\n\t\t\t\t\t'source_url',\n\t\t\t\t] );\n\t\t}\n\n\t\tlet newHref = href;\n\t\tif ( linkDestination === LINK_DESTINATION_MEDIA ) {\n\t\t\t// Update the media link.\n\t\t\tnewHref = media.url;\n\t\t}\n\n\t\t// Check if the image is linked to the attachment page.\n\t\tif ( linkDestination === LINK_DESTINATION_ATTACHMENT ) {\n\t\t\t// Update the media link.\n\t\t\tnewHref = media.link;\n\t\t}\n\n\t\tsetAttributes( {\n\t\t\tmediaAlt: media.alt,\n\t\t\tmediaId: media.id,\n\t\t\tmediaType,\n\t\t\tmediaUrl: src || media.url,\n\t\t\tmediaLink: media.link || undefined,\n\t\t\thref: newHref,\n\t\t\tfocalPoint: undefined,\n\t\t} );\n\t}\n\n\tonWidthChange( width ) {\n\t\tthis.setState( {\n\t\t\tmediaWidth: applyWidthConstraints( width ),\n\t\t} );\n\t}\n\n\tonSetHref( props ) {\n\t\tthis.props.setAttributes( props );\n\t}\n\n\tcommitWidthChange( width ) {\n\t\tconst { setAttributes } = this.props;\n\n\t\tsetAttributes( {\n\t\t\tmediaWidth: applyWidthConstraints( width ),\n\t\t} );\n\t\tthis.setState( {\n\t\t\tmediaWidth: null,\n\t\t} );\n\t}\n\n\trenderMediaArea() {\n\t\tconst { attributes } = this.props;\n\t\tconst {\n\t\t\tmediaAlt,\n\t\t\tmediaId,\n\t\t\tmediaPosition,\n\t\t\tmediaType,\n\t\t\tmediaUrl,\n\t\t\tmediaWidth,\n\t\t\timageFill,\n\t\t\tfocalPoint,\n\t\t} = attributes;\n\t\treturn (\n\t\t\t<MediaContainer\n\t\t\t\tclassName=\"block-library-media-text__media-container\"\n\t\t\t\tonSelectMedia={ this.onSelectMedia }\n\t\t\t\tonWidthChange={ this.onWidthChange }\n\t\t\t\tcommitWidthChange={ this.commitWidthChange }\n\t\t\t\t{ ...{\n\t\t\t\t\tmediaAlt,\n\t\t\t\t\tmediaId,\n\t\t\t\t\tmediaType,\n\t\t\t\t\tmediaUrl,\n\t\t\t\t\tmediaPosition,\n\t\t\t\t\tmediaWidth,\n\t\t\t\t\timageFill,\n\t\t\t\t\tfocalPoint,\n\t\t\t\t} }\n\t\t\t/>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tattributes,\n\t\t\tclassName,\n\t\t\tbackgroundColor,\n\t\t\tisSelected,\n\t\t\tsetAttributes,\n\t\t\tsetBackgroundColor,\n\t\t\timage,\n\t\t} = this.props;\n\t\tconst {\n\t\t\tisStackedOnMobile,\n\t\t\tmediaAlt,\n\t\t\tmediaPosition,\n\t\t\tmediaType,\n\t\t\tmediaWidth,\n\t\t\tverticalAlignment,\n\t\t\tmediaUrl,\n\t\t\timageFill,\n\t\t\tfocalPoint,\n\t\t\trel,\n\t\t\thref,\n\t\t\tlinkTarget,\n\t\t\tlinkClass,\n\t\t\tlinkDestination,\n\t\t} = attributes;\n\n\t\tconst temporaryMediaWidth = this.state.mediaWidth;\n\t\tconst classNames = classnames( className, {\n\t\t\t'has-media-on-the-right': 'right' === mediaPosition,\n\t\t\t'is-selected': isSelected,\n\t\t\t'has-background': backgroundColor.class || backgroundColor.color,\n\t\t\t[ backgroundColor.class ]: backgroundColor.class,\n\t\t\t'is-stacked-on-mobile': isStackedOnMobile,\n\t\t\t[ `is-vertically-aligned-${ verticalAlignment }` ]: verticalAlignment,\n\t\t\t'is-image-fill': imageFill,\n\t\t} );\n\t\tconst widthString = `${ temporaryMediaWidth || mediaWidth }%`;\n\t\tconst gridTemplateColumns =\n\t\t\t'right' === mediaPosition\n\t\t\t\t? `1fr ${ widthString }`\n\t\t\t\t: `${ widthString } 1fr`;\n\t\tconst style = {\n\t\t\tgridTemplateColumns,\n\t\t\tmsGridColumns: gridTemplateColumns,\n\t\t\tbackgroundColor: backgroundColor.color,\n\t\t};\n\t\tconst colorSettings = [\n\t\t\t{\n\t\t\t\tvalue: backgroundColor.color,\n\t\t\t\tonChange: setBackgroundColor,\n\t\t\t\tlabel: __( 'Background Color' ),\n\t\t\t},\n\t\t];\n\t\tconst toolbarControls = [\n\t\t\t{\n\t\t\t\ticon: 'align-pull-left',\n\t\t\t\ttitle: __( 'Show media on left' ),\n\t\t\t\tisActive: mediaPosition === 'left',\n\t\t\t\tonClick: () => setAttributes( { mediaPosition: 'left' } ),\n\t\t\t},\n\t\t\t{\n\t\t\t\ticon: 'align-pull-right',\n\t\t\t\ttitle: __( 'Show media on right' ),\n\t\t\t\tisActive: mediaPosition === 'right',\n\t\t\t\tonClick: () => setAttributes( { mediaPosition: 'right' } ),\n\t\t\t},\n\t\t];\n\t\tconst onMediaAltChange = ( newMediaAlt ) => {\n\t\t\tsetAttributes( { mediaAlt: newMediaAlt } );\n\t\t};\n\t\tconst onVerticalAlignmentChange = ( alignment ) => {\n\t\t\tsetAttributes( { verticalAlignment: alignment } );\n\t\t};\n\t\tconst mediaTextGeneralSettings = (\n\t\t\t<PanelBody title={ __( 'Media & Text settings' ) }>\n\t\t\t\t<ToggleControl\n\t\t\t\t\tlabel={ __( 'Stack on mobile' ) }\n\t\t\t\t\tchecked={ isStackedOnMobile }\n\t\t\t\t\tonChange={ () =>\n\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\tisStackedOnMobile: ! isStackedOnMobile,\n\t\t\t\t\t\t} )\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t\t{ mediaType === 'image' && (\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Crop image to fill entire column' ) }\n\t\t\t\t\t\tchecked={ imageFill }\n\t\t\t\t\t\tonChange={ () =>\n\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\timageFill: ! imageFill,\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t\t{ imageFill && (\n\t\t\t\t\t<FocalPointPicker\n\t\t\t\t\t\tlabel={ __( 'Focal Point Picker' ) }\n\t\t\t\t\t\turl={ mediaUrl }\n\t\t\t\t\t\tvalue={ focalPoint }\n\t\t\t\t\t\tonChange={ ( value ) =>\n\t\t\t\t\t\t\tsetAttributes( { focalPoint: value } )\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t\t{ mediaType === 'image' && (\n\t\t\t\t\t<TextareaControl\n\t\t\t\t\t\tlabel={ __( 'Alt Text (Alternative Text)' ) }\n\t\t\t\t\t\tvalue={ mediaAlt }\n\t\t\t\t\t\tonChange={ onMediaAltChange }\n\t\t\t\t\t\thelp={\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<ExternalLink href=\"https://www.w3.org/WAI/tutorials/images/decision-tree\">\n\t\t\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t\t\t'Describe the purpose of the image'\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t</ExternalLink>\n\t\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t\t'Leave empty if the image is purely decorative.'\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</PanelBody>\n\t\t);\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<InspectorControls>\n\t\t\t\t\t{ mediaTextGeneralSettings }\n\t\t\t\t\t<PanelColorSettings\n\t\t\t\t\t\ttitle={ __( 'Color settings' ) }\n\t\t\t\t\t\tinitialOpen={ false }\n\t\t\t\t\t\tcolorSettings={ colorSettings }\n\t\t\t\t\t/>\n\t\t\t\t</InspectorControls>\n\t\t\t\t<BlockControls>\n\t\t\t\t\t<ToolbarGroup controls={ toolbarControls } />\n\t\t\t\t\t<BlockVerticalAlignmentToolbar\n\t\t\t\t\t\tonChange={ onVerticalAlignmentChange }\n\t\t\t\t\t\tvalue={ verticalAlignment }\n\t\t\t\t\t/>\n\t\t\t\t\t{ mediaType === 'image' && (\n\t\t\t\t\t\t<ToolbarGroup>\n\t\t\t\t\t\t\t<ImageURLInputUI\n\t\t\t\t\t\t\t\turl={ href || '' }\n\t\t\t\t\t\t\t\tonChangeUrl={ this.onSetHref }\n\t\t\t\t\t\t\t\tlinkDestination={ linkDestination }\n\t\t\t\t\t\t\t\tmediaType={ mediaType }\n\t\t\t\t\t\t\t\tmediaUrl={ image && image.source_url }\n\t\t\t\t\t\t\t\tmediaLink={ image && image.link }\n\t\t\t\t\t\t\t\tlinkTarget={ linkTarget }\n\t\t\t\t\t\t\t\tlinkClass={ linkClass }\n\t\t\t\t\t\t\t\trel={ rel }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</ToolbarGroup>\n\t\t\t\t\t) }\n\t\t\t\t</BlockControls>\n\t\t\t\t<div className={ classNames } style={ style }>\n\t\t\t\t\t{ this.renderMediaArea() }\n\t\t\t\t\t<InnerBlocks\n\t\t\t\t\t\ttemplate={ TEMPLATE }\n\t\t\t\t\t\ttemplateInsertUpdatesSelection={ false }\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithColors( 'backgroundColor' ),\n\twithSelect( ( select, props ) => {\n\t\tconst { getMedia } = select( 'core' );\n\t\tconst {\n\t\t\tattributes: { mediaId },\n\t\t\tisSelected,\n\t\t} = props;\n\t\treturn {\n\t\t\timage: mediaId && isSelected ? getMedia( mediaId ) : null,\n\t\t};\n\t} ),\n] )( MediaTextEdit );\n"]}