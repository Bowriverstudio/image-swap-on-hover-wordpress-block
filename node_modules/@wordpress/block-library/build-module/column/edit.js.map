{"version":3,"sources":["@wordpress/block-library/src/column/edit.js"],"names":["classnames","forEach","find","difference","InnerBlocks","BlockControls","BlockVerticalAlignmentToolbar","InspectorControls","PanelBody","RangeControl","withDispatch","withSelect","compose","__","toWidthPrecision","getTotalColumnsWidth","getColumnWidths","getAdjacentBlocks","getRedistributedColumnWidths","ColumnEdit","attributes","className","updateAlignment","updateWidth","hasChildBlocks","verticalAlignment","width","classes","undefined","select","ownProps","clientId","getBlockOrder","length","dispatch","registry","setAttributes","updateBlockAttributes","getBlockRootClientId","rootClientId","getBlocks","columns","adjacentColumns","occupiedWidth","nextColumnWidths","nextColumnWidth","columnClientId"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { forEach, find, difference } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tInnerBlocks,\n\tBlockControls,\n\tBlockVerticalAlignmentToolbar,\n\tInspectorControls,\n} from '@wordpress/block-editor';\nimport { PanelBody, RangeControl } from '@wordpress/components';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport {\n\ttoWidthPrecision,\n\tgetTotalColumnsWidth,\n\tgetColumnWidths,\n\tgetAdjacentBlocks,\n\tgetRedistributedColumnWidths,\n} from '../columns/utils';\n\nfunction ColumnEdit( {\n\tattributes,\n\tclassName,\n\tupdateAlignment,\n\tupdateWidth,\n\thasChildBlocks,\n} ) {\n\tconst { verticalAlignment, width } = attributes;\n\n\tconst classes = classnames( className, 'block-core-columns', {\n\t\t[ `is-vertically-aligned-${ verticalAlignment }` ]: verticalAlignment,\n\t} );\n\n\treturn (\n\t\t<div className={ classes }>\n\t\t\t<BlockControls>\n\t\t\t\t<BlockVerticalAlignmentToolbar\n\t\t\t\t\tonChange={ updateAlignment }\n\t\t\t\t\tvalue={ verticalAlignment }\n\t\t\t\t/>\n\t\t\t</BlockControls>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Column settings' ) }>\n\t\t\t\t\t<RangeControl\n\t\t\t\t\t\tlabel={ __( 'Percentage width' ) }\n\t\t\t\t\t\tvalue={ width || '' }\n\t\t\t\t\t\tonChange={ updateWidth }\n\t\t\t\t\t\tmin={ 0 }\n\t\t\t\t\t\tmax={ 100 }\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tallowReset\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t<InnerBlocks\n\t\t\t\ttemplateLock={ false }\n\t\t\t\trenderAppender={\n\t\t\t\t\thasChildBlocks\n\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t: () => <InnerBlocks.ButtonBlockAppender />\n\t\t\t\t}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n\nexport default compose(\n\twithSelect( ( select, ownProps ) => {\n\t\tconst { clientId } = ownProps;\n\t\tconst { getBlockOrder } = select( 'core/block-editor' );\n\n\t\treturn {\n\t\t\thasChildBlocks: getBlockOrder( clientId ).length > 0,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, ownProps, registry ) => {\n\t\treturn {\n\t\t\tupdateAlignment( verticalAlignment ) {\n\t\t\t\tconst { clientId, setAttributes } = ownProps;\n\t\t\t\tconst { updateBlockAttributes } = dispatch(\n\t\t\t\t\t'core/block-editor'\n\t\t\t\t);\n\t\t\t\tconst { getBlockRootClientId } = registry.select(\n\t\t\t\t\t'core/block-editor'\n\t\t\t\t);\n\n\t\t\t\t// Update own alignment.\n\t\t\t\tsetAttributes( { verticalAlignment } );\n\n\t\t\t\t// Reset Parent Columns Block\n\t\t\t\tconst rootClientId = getBlockRootClientId( clientId );\n\t\t\t\tupdateBlockAttributes( rootClientId, {\n\t\t\t\t\tverticalAlignment: null,\n\t\t\t\t} );\n\t\t\t},\n\t\t\tupdateWidth( width ) {\n\t\t\t\tconst { clientId } = ownProps;\n\t\t\t\tconst { updateBlockAttributes } = dispatch(\n\t\t\t\t\t'core/block-editor'\n\t\t\t\t);\n\t\t\t\tconst { getBlockRootClientId, getBlocks } = registry.select(\n\t\t\t\t\t'core/block-editor'\n\t\t\t\t);\n\n\t\t\t\t// Constrain or expand siblings to account for gain or loss of\n\t\t\t\t// total columns area.\n\t\t\t\tconst columns = getBlocks( getBlockRootClientId( clientId ) );\n\t\t\t\tconst adjacentColumns = getAdjacentBlocks( columns, clientId );\n\n\t\t\t\t// The occupied width is calculated as the sum of the new width\n\t\t\t\t// and the total width of blocks _not_ in the adjacent set.\n\t\t\t\tconst occupiedWidth =\n\t\t\t\t\twidth +\n\t\t\t\t\tgetTotalColumnsWidth(\n\t\t\t\t\t\tdifference( columns, [\n\t\t\t\t\t\t\tfind( columns, { clientId } ),\n\t\t\t\t\t\t\t...adjacentColumns,\n\t\t\t\t\t\t] )\n\t\t\t\t\t);\n\n\t\t\t\t// Compute _all_ next column widths, in case the updated column\n\t\t\t\t// is in the middle of a set of columns which don't yet have\n\t\t\t\t// any explicit widths assigned (include updates to those not\n\t\t\t\t// part of the adjacent blocks).\n\t\t\t\tconst nextColumnWidths = {\n\t\t\t\t\t...getColumnWidths( columns, columns.length ),\n\t\t\t\t\t[ clientId ]: toWidthPrecision( width ),\n\t\t\t\t\t...getRedistributedColumnWidths(\n\t\t\t\t\t\tadjacentColumns,\n\t\t\t\t\t\t100 - occupiedWidth,\n\t\t\t\t\t\tcolumns.length\n\t\t\t\t\t),\n\t\t\t\t};\n\n\t\t\t\tforEach(\n\t\t\t\t\tnextColumnWidths,\n\t\t\t\t\t( nextColumnWidth, columnClientId ) => {\n\t\t\t\t\t\tupdateBlockAttributes( columnClientId, {\n\t\t\t\t\t\t\twidth: nextColumnWidth,\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\t\t};\n\t} )\n)( ColumnEdit );\n"]}