{"version":3,"sources":["@wordpress/block-editor/src/components/colors/use-colors.js"],"names":["window","getComputedStyle","Node","DEFAULT_COLORS","resolveContrastCheckerColor","color","colorSettings","detectedColor","ColorPanel","title","colorPanelProps","contrastCheckers","detectedBackgroundColor","panelChildren","initialOpen","Object","values","Array","isArray","map","backgroundColor","textColor","rest","value","InspectorControlsColorPanel","props","__experimentalUseColors","colorConfigs","panelTitle","colorDetector","targetRef","backgroundColorTargetRef","textColorTargetRef","deps","clientId","select","getBlockAttributes","getSettings","colors","attributes","settingsColors","updateBlockAttributes","setAttributes","newAttributes","createComponent","name","property","className","colorValue","customColor","children","componentClassName","style","componentStyle","Children","child","colorStyle","maxSize","length","createSetColor","newColor","find","_color","undefined","slug","setDetectedBackgroundColor","setDetectedColor","needsBackgroundColor","needsColor","current","backgroundColorNode","parentNode","nodeType","ELEMENT_NODE","reduce","acc","colorConfig","components","panelLabel","componentName","replace","__color","displayName","setColor","onChange","label","wrappedColorPanelProps"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport memoize from 'memize';\nimport classnames from 'classnames';\nimport { map, kebabCase, camelCase, castArray, startCase } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport {\n\tuseCallback,\n\tuseMemo,\n\tuseEffect,\n\tChildren,\n\tcloneElement,\n\tuseState,\n} from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport PanelColorSettings from '../panel-color-settings';\nimport ContrastChecker from '../contrast-checker';\nimport InspectorControls from '../inspector-controls';\nimport { useBlockEditContext } from '../block-edit';\n\n/**\n * Browser dependencies\n */\nconst { getComputedStyle, Node } = window;\n\nconst DEFAULT_COLORS = [];\n\nconst resolveContrastCheckerColor = ( color, colorSettings, detectedColor ) => {\n\tif ( typeof color === 'function' ) {\n\t\treturn color( colorSettings );\n\t} else if ( color === true ) {\n\t\treturn detectedColor;\n\t}\n\treturn color;\n};\n\nconst ColorPanel = ( {\n\ttitle,\n\tcolorSettings,\n\tcolorPanelProps,\n\tcontrastCheckers,\n\tdetectedBackgroundColor,\n\tdetectedColor,\n\tpanelChildren,\n\tinitialOpen,\n} ) => (\n\t<PanelColorSettings\n\t\ttitle={ title }\n\t\tinitialOpen={ initialOpen }\n\t\tcolorSettings={ Object.values( colorSettings ) }\n\t\t{ ...colorPanelProps }\n\t>\n\t\t{ contrastCheckers &&\n\t\t\t( Array.isArray( contrastCheckers )\n\t\t\t\t? contrastCheckers.map(\n\t\t\t\t\t\t( { backgroundColor, textColor, ...rest } ) => {\n\t\t\t\t\t\t\tbackgroundColor = resolveContrastCheckerColor(\n\t\t\t\t\t\t\t\tbackgroundColor,\n\t\t\t\t\t\t\t\tcolorSettings,\n\t\t\t\t\t\t\t\tdetectedBackgroundColor\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\ttextColor = resolveContrastCheckerColor(\n\t\t\t\t\t\t\t\ttextColor,\n\t\t\t\t\t\t\t\tcolorSettings,\n\t\t\t\t\t\t\t\tdetectedColor\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<ContrastChecker\n\t\t\t\t\t\t\t\t\tkey={ `${ backgroundColor }-${ textColor }` }\n\t\t\t\t\t\t\t\t\tbackgroundColor={ backgroundColor }\n\t\t\t\t\t\t\t\t\ttextColor={ textColor }\n\t\t\t\t\t\t\t\t\t{ ...rest }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t  )\n\t\t\t\t: map( colorSettings, ( { value } ) => {\n\t\t\t\t\t\tlet { backgroundColor, textColor } = contrastCheckers;\n\t\t\t\t\t\tbackgroundColor = resolveContrastCheckerColor(\n\t\t\t\t\t\t\tbackgroundColor || value,\n\t\t\t\t\t\t\tcolorSettings,\n\t\t\t\t\t\t\tdetectedBackgroundColor\n\t\t\t\t\t\t);\n\t\t\t\t\t\ttextColor = resolveContrastCheckerColor(\n\t\t\t\t\t\t\ttextColor || value,\n\t\t\t\t\t\t\tcolorSettings,\n\t\t\t\t\t\t\tdetectedColor\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<ContrastChecker\n\t\t\t\t\t\t\t\t{ ...contrastCheckers }\n\t\t\t\t\t\t\t\tkey={ `${ backgroundColor }-${ textColor }` }\n\t\t\t\t\t\t\t\tbackgroundColor={ backgroundColor }\n\t\t\t\t\t\t\t\ttextColor={ textColor }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t  } ) ) }\n\t\t{ typeof panelChildren === 'function'\n\t\t\t? panelChildren( colorSettings )\n\t\t\t: panelChildren }\n\t</PanelColorSettings>\n);\nconst InspectorControlsColorPanel = ( props ) => (\n\t<InspectorControls>\n\t\t<ColorPanel { ...props } />\n\t</InspectorControls>\n);\n\nexport default function __experimentalUseColors(\n\tcolorConfigs,\n\t{\n\t\tpanelTitle = __( 'Color settings' ),\n\t\tcolorPanelProps,\n\t\tcontrastCheckers,\n\t\tpanelChildren,\n\t\tcolorDetector: {\n\t\t\ttargetRef,\n\t\t\tbackgroundColorTargetRef = targetRef,\n\t\t\ttextColorTargetRef = targetRef,\n\t\t} = {},\n\t} = {\n\t\tpanelTitle: __( 'Color settings' ),\n\t},\n\tdeps = []\n) {\n\tconst { clientId } = useBlockEditContext();\n\tconst { attributes, settingsColors } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getBlockAttributes, getSettings } = select(\n\t\t\t\t'core/block-editor'\n\t\t\t);\n\t\t\tconst colors = getSettings().colors;\n\t\t\treturn {\n\t\t\t\tattributes: getBlockAttributes( clientId ),\n\t\t\t\tsettingsColors:\n\t\t\t\t\t! colors || colors === true ? DEFAULT_COLORS : colors,\n\t\t\t};\n\t\t},\n\t\t[ clientId ]\n\t);\n\tconst { updateBlockAttributes } = useDispatch( 'core/block-editor' );\n\tconst setAttributes = useCallback(\n\t\t( newAttributes ) => updateBlockAttributes( clientId, newAttributes ),\n\t\t[ updateBlockAttributes, clientId ]\n\t);\n\n\tconst createComponent = useMemo(\n\t\t() =>\n\t\t\tmemoize(\n\t\t\t\t(\n\t\t\t\t\tname,\n\t\t\t\t\tproperty,\n\t\t\t\t\tclassName,\n\t\t\t\t\tcolor,\n\t\t\t\t\tcolorValue,\n\t\t\t\t\tcustomColor\n\t\t\t\t) => ( {\n\t\t\t\t\tchildren,\n\t\t\t\t\tclassName: componentClassName = '',\n\t\t\t\t\tstyle: componentStyle = {},\n\t\t\t\t} ) =>\n\t\t\t\t\t// Clone children, setting the style property from the color configuration,\n\t\t\t\t\t// if not already set explicitly through props.\n\t\t\t\t\tChildren.map( children, ( child ) => {\n\t\t\t\t\t\tlet colorStyle = {};\n\t\t\t\t\t\tif ( color ) {\n\t\t\t\t\t\t\tcolorStyle = { [ property ]: colorValue };\n\t\t\t\t\t\t} else if ( customColor ) {\n\t\t\t\t\t\t\tcolorStyle = { [ property ]: customColor };\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn cloneElement( child, {\n\t\t\t\t\t\t\tclassName: classnames(\n\t\t\t\t\t\t\t\tcomponentClassName,\n\t\t\t\t\t\t\t\tchild.props.className,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t[ `has-${ kebabCase( color ) }-${ kebabCase(\n\t\t\t\t\t\t\t\t\t\tproperty\n\t\t\t\t\t\t\t\t\t) }` ]: color,\n\t\t\t\t\t\t\t\t\t[ className ||\n\t\t\t\t\t\t\t\t\t`has-${ kebabCase( name ) }` ]:\n\t\t\t\t\t\t\t\t\t\tcolor || customColor,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t...colorStyle,\n\t\t\t\t\t\t\t\t...componentStyle,\n\t\t\t\t\t\t\t\t...( child.props.style || {} ),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t} );\n\t\t\t\t\t} ),\n\t\t\t\t{ maxSize: colorConfigs.length }\n\t\t\t),\n\t\t[ colorConfigs.length ]\n\t);\n\tconst createSetColor = useMemo(\n\t\t() =>\n\t\t\tmemoize(\n\t\t\t\t( name, colors ) => ( newColor ) => {\n\t\t\t\t\tconst color = colors.find(\n\t\t\t\t\t\t( _color ) => _color.color === newColor\n\t\t\t\t\t);\n\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t[ color\n\t\t\t\t\t\t\t? camelCase( `custom ${ name }` )\n\t\t\t\t\t\t\t: name ]: undefined,\n\t\t\t\t\t} );\n\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t[ color\n\t\t\t\t\t\t\t? name\n\t\t\t\t\t\t\t: camelCase( `custom ${ name }` ) ]: color\n\t\t\t\t\t\t\t? color.slug\n\t\t\t\t\t\t\t: newColor,\n\t\t\t\t\t} );\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmaxSize: colorConfigs.length,\n\t\t\t\t}\n\t\t\t),\n\t\t[ setAttributes, colorConfigs.length ]\n\t);\n\n\tconst [ detectedBackgroundColor, setDetectedBackgroundColor ] = useState();\n\tconst [ detectedColor, setDetectedColor ] = useState();\n\n\tuseEffect( () => {\n\t\tif ( ! contrastCheckers ) {\n\t\t\treturn undefined;\n\t\t}\n\t\tlet needsBackgroundColor = false;\n\t\tlet needsColor = false;\n\t\tfor ( const { backgroundColor, textColor } of castArray(\n\t\t\tcontrastCheckers\n\t\t) ) {\n\t\t\tif ( ! needsBackgroundColor ) {\n\t\t\t\tneedsBackgroundColor = backgroundColor === true;\n\t\t\t}\n\t\t\tif ( ! needsColor ) {\n\t\t\t\tneedsColor = textColor === true;\n\t\t\t}\n\t\t\tif ( needsBackgroundColor && needsColor ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif ( needsColor ) {\n\t\t\tsetDetectedColor(\n\t\t\t\tgetComputedStyle( textColorTargetRef.current ).color\n\t\t\t);\n\t\t}\n\n\t\tif ( needsBackgroundColor ) {\n\t\t\tlet backgroundColorNode = backgroundColorTargetRef.current;\n\t\t\tlet backgroundColor = getComputedStyle( backgroundColorNode )\n\t\t\t\t.backgroundColor;\n\t\t\twhile (\n\t\t\t\tbackgroundColor === 'rgba(0, 0, 0, 0)' &&\n\t\t\t\tbackgroundColorNode.parentNode &&\n\t\t\t\tbackgroundColorNode.parentNode.nodeType === Node.ELEMENT_NODE\n\t\t\t) {\n\t\t\t\tbackgroundColorNode = backgroundColorNode.parentNode;\n\t\t\t\tbackgroundColor = getComputedStyle( backgroundColorNode )\n\t\t\t\t\t.backgroundColor;\n\t\t\t}\n\n\t\t\tsetDetectedBackgroundColor( backgroundColor );\n\t\t}\n\t}, [\n\t\tcolorConfigs.reduce(\n\t\t\t( acc, colorConfig ) =>\n\t\t\t\t`${ acc } | ${ attributes[ colorConfig.name ] } | ${\n\t\t\t\t\tattributes[ camelCase( `custom ${ colorConfig.name }` ) ]\n\t\t\t\t}`,\n\t\t\t''\n\t\t),\n\t\t...deps,\n\t] );\n\n\treturn useMemo( () => {\n\t\tconst colorSettings = {};\n\n\t\tconst components = colorConfigs.reduce( ( acc, colorConfig ) => {\n\t\t\tif ( typeof colorConfig === 'string' ) {\n\t\t\t\tcolorConfig = { name: colorConfig };\n\t\t\t}\n\t\t\tconst {\n\t\t\t\tname, // E.g. 'backgroundColor'.\n\t\t\t\tproperty = name, // E.g. 'backgroundColor'.\n\t\t\t\tclassName,\n\n\t\t\t\tpanelLabel = startCase( name ), // E.g. 'Background Color'.\n\t\t\t\tcomponentName = panelLabel.replace( /\\s/g, '' ), // E.g. 'BackgroundColor'.\n\n\t\t\t\tcolor = colorConfig.color,\n\t\t\t\tcolors = settingsColors,\n\t\t\t} = {\n\t\t\t\t...colorConfig,\n\t\t\t\tcolor: attributes[ colorConfig.name ],\n\t\t\t};\n\n\t\t\tconst customColor = attributes[ camelCase( `custom ${ name }` ) ];\n\t\t\t// We memoize the non-primitives to avoid unnecessary updates\n\t\t\t// when they are used as props for other components.\n\t\t\tconst _color = customColor\n\t\t\t\t? undefined\n\t\t\t\t: colors.find( ( __color ) => __color.slug === color );\n\t\t\tacc[ componentName ] = createComponent(\n\t\t\t\tname,\n\t\t\t\tproperty,\n\t\t\t\tclassName,\n\t\t\t\tcolor,\n\t\t\t\t_color && _color.color,\n\t\t\t\tcustomColor\n\t\t\t);\n\t\t\tacc[ componentName ].displayName = componentName;\n\t\t\tacc[ componentName ].color = customColor\n\t\t\t\t? customColor\n\t\t\t\t: _color && _color.color;\n\t\t\tacc[ componentName ].slug = color;\n\t\t\tacc[ componentName ].setColor = createSetColor( name, colors );\n\n\t\t\tcolorSettings[ componentName ] = {\n\t\t\t\tvalue: _color\n\t\t\t\t\t? _color.color\n\t\t\t\t\t: attributes[ camelCase( `custom ${ name }` ) ],\n\t\t\t\tonChange: acc[ componentName ].setColor,\n\t\t\t\tlabel: panelLabel,\n\t\t\t\tcolors,\n\t\t\t};\n\t\t\t// These settings will be spread over the `colors` in\n\t\t\t// `colorPanelProps`, so we need to unset the key here,\n\t\t\t// if not set to an actual value, to avoid overwriting\n\t\t\t// an actual value in `colorPanelProps`.\n\t\t\tif ( ! colors ) {\n\t\t\t\tdelete colorSettings[ componentName ].colors;\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t}, {} );\n\n\t\tconst wrappedColorPanelProps = {\n\t\t\ttitle: panelTitle,\n\t\t\tinitialOpen: false,\n\t\t\tcolorSettings,\n\t\t\tcolorPanelProps,\n\t\t\tcontrastCheckers,\n\t\t\tdetectedBackgroundColor,\n\t\t\tdetectedColor,\n\t\t\tpanelChildren,\n\t\t};\n\t\treturn {\n\t\t\t...components,\n\t\t\tColorPanel: <ColorPanel { ...wrappedColorPanelProps } />,\n\t\t\tInspectorControlsColorPanel: (\n\t\t\t\t<InspectorControlsColorPanel { ...wrappedColorPanelProps } />\n\t\t\t),\n\t\t};\n\t}, [\n\t\tattributes,\n\t\tsetAttributes,\n\t\tdetectedColor,\n\t\tdetectedBackgroundColor,\n\t\t...deps,\n\t] );\n}\n"]}