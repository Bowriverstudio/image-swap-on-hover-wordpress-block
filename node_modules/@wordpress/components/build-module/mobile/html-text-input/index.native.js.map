{"version":3,"sources":["@wordpress/components/src/mobile/html-text-input/index.native.js"],"names":["TextInput","Component","__","parse","withDispatch","withSelect","addAction","removeAction","withInstanceId","compose","withPreferredColorScheme","HTMLInputContainer","styles","HTMLTextInput","arguments","edit","bind","stopEditing","state","html","props","onChange","setState","value","isDirty","onPersist","getStylesFromColorScheme","htmlStyle","htmlView","htmlViewDark","placeholderStyle","placeholder","placeholderDark","parentHeight","htmlViewTitle","title","color","editTitle","scrollEnabled","select","getEditedPostAttribute","getEditedPostContent","dispatch","editPost","resetEditorBlocks","content","blocks"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { TextInput } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { parse } from '@wordpress/blocks';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { addAction, removeAction } from '@wordpress/hooks';\nimport { withInstanceId, compose, withPreferredColorScheme } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport HTMLInputContainer from './container';\nimport styles from './style.scss';\n\nexport class HTMLTextInput extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.edit = this.edit.bind( this );\n\t\tthis.stopEditing = this.stopEditing.bind( this );\n\t\taddAction( 'native-editor.persist-html', 'core/editor', this.stopEditing );\n\n\t\tthis.state = {};\n\t}\n\n\tstatic getDerivedStateFromProps( props, state ) {\n\t\tif ( state.isDirty ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tvalue: props.value,\n\t\t\tisDirty: false,\n\t\t};\n\t}\n\n\tcomponentWillUnmount() {\n\t\tremoveAction( 'native-editor.persist-html', 'core/editor' );\n\t\t//TODO: Blocking main thread\n\t\tthis.stopEditing();\n\t}\n\n\tedit( html ) {\n\t\tthis.props.onChange( html );\n\t\tthis.setState( { value: html, isDirty: true } );\n\t}\n\n\tstopEditing() {\n\t\tif ( this.state.isDirty ) {\n\t\t\tthis.props.onPersist( this.state.value );\n\t\t\tthis.setState( { isDirty: false } );\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { getStylesFromColorScheme } = this.props;\n\t\tconst htmlStyle = getStylesFromColorScheme( styles.htmlView, styles.htmlViewDark );\n\t\tconst placeholderStyle = getStylesFromColorScheme( styles.placeholder, styles.placeholderDark );\n\t\treturn (\n\t\t\t<HTMLInputContainer parentHeight={ this.props.parentHeight }>\n\t\t\t\t<TextInput\n\t\t\t\t\tautoCorrect={ false }\n\t\t\t\t\taccessibilityLabel=\"html-view-title\"\n\t\t\t\t\ttextAlignVertical=\"center\"\n\t\t\t\t\tnumberOfLines={ 1 }\n\t\t\t\t\tstyle={ styles.htmlViewTitle }\n\t\t\t\t\tvalue={ this.props.title }\n\t\t\t\t\tplaceholder={ __( 'Add title' ) }\n\t\t\t\t\tplaceholderTextColor={ placeholderStyle.color }\n\t\t\t\t\tonChangeText={ this.props.editTitle }\n\t\t\t\t/>\n\t\t\t\t<TextInput\n\t\t\t\t\tautoCorrect={ false }\n\t\t\t\t\taccessibilityLabel=\"html-view-content\"\n\t\t\t\t\ttextAlignVertical=\"top\"\n\t\t\t\t\tmultiline\n\t\t\t\t\tstyle={ htmlStyle }\n\t\t\t\t\tvalue={ this.state.value }\n\t\t\t\t\tonChangeText={ this.edit }\n\t\t\t\t\tonBlur={ this.stopEditing }\n\t\t\t\t\tplaceholder={ __( 'Start writingâ€¦' ) }\n\t\t\t\t\tplaceholderTextColor={ placeholderStyle.color }\n\t\t\t\t\tscrollEnabled={ HTMLInputContainer.scrollEnabled }\n\t\t\t\t/>\n\t\t\t</HTMLInputContainer>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst {\n\t\t\tgetEditedPostAttribute,\n\t\t\tgetEditedPostContent,\n\t\t} = select( 'core/editor' );\n\n\t\treturn {\n\t\t\ttitle: getEditedPostAttribute( 'title' ),\n\t\t\tvalue: getEditedPostContent(),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { editPost, resetEditorBlocks } = dispatch( 'core/editor' );\n\t\treturn {\n\t\t\teditTitle( title ) {\n\t\t\t\teditPost( { title } );\n\t\t\t},\n\t\t\tonChange( content ) {\n\t\t\t\teditPost( { content } );\n\t\t\t},\n\t\t\tonPersist( content ) {\n\t\t\t\tconst blocks = parse( content );\n\t\t\t\tresetEditorBlocks( blocks );\n\t\t\t},\n\t\t};\n\t} ),\n\twithInstanceId,\n\twithPreferredColorScheme,\n] )( HTMLTextInput );\n"]}